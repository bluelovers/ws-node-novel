{"version":3,"file":"util.js","sourceRoot":"","sources":["util.ts"],"names":[],"mappings":"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","sourcesContent":["/**\n * Created by user on 2019/1/6/006.\n */\n\nimport moment = require('moment');\nimport { _trim, createSortCallback, defaultSortCallback, EnumToLowerCase, naturalCompare } from '@node-novel/sort';\nimport StrUtil = require('str-util');\nimport sortObject = require('sort-object-keys2');\n\nlet defaultOffset = 8;\n\nexport { naturalCompare }\n\nexport function createMoment(...argv)\n{\n\treturn moment(...argv).utcOffset(defaultOffset);\n}\n\nconst todayMoment = createMoment().startOf('day');\n\nexport let todayMomentTimestamp = todayMoment.valueOf();\nexport let todayMomentOffset = todayMoment.utcOffset();\n\nexport default todayMomentTimestamp\n\nexport function getTodayMomentTimestamp()\n{\n\treturn todayMoment.valueOf();\n}\n\nexport function refreshTodayMoment()\n{\n\tlet k = createMoment()\n\t\t//.add(7, 'days')\n\t\t.startOf('day')\n\t;\n\n\tif (k.valueOf() != todayMoment.valueOf())\n\t{\n\t\ttodayMoment.set(k.toObject());\n\n\t\treturn true;\n\t}\n}\n\nObject.defineProperties(exports, {\n\ttodayMomentTimestamp: {\n\t\tget: getTodayMomentTimestamp,\n\t},\n\ttodayMomentOffset: {\n\t\tget()\n\t\t{\n\t\t\treturn todayMoment.utcOffset();\n\t\t},\n\t},\n});\n\nexport const cacheSortCallback = createSortCallback({\n\tdotNum: true,\n\ttranspileBase(input: string, isSub?: any)\n\t{\n\t\tlet s = StrUtil.toHalfWidth(input);\n\t\treturn s\n\t},\n\ttoLowerCase: EnumToLowerCase.toLocaleLowerCase,\n});\n\nexport function freezeProperty<T>(who: T, prop: keyof T, freeze?: boolean)\n{\n\tif (freeze)\n\t{\n\t\ttry\n\t\t{\n\t\t\t// @ts-ignore\n\t\t\twho[prop] = Object.freeze(who[prop]);\n\t\t}\n\t\tcatch (e)\n\t\t{\n\n\t\t}\n\t}\n\n\tObject.defineProperty(who, prop, {\n\t\tconfigurable: false,\n\t\twritable: false,\n\t});\n\n\treturn who;\n}\n\nexport function baseSortObject<T>(data: T): T\n{\n\treturn sortObject(data, {\n\t\tuseSource: true,\n\t\tkeys: Object.keys(data).sort(),\n\t});\n}\n\nexport function tryRequireFS(): typeof import('fs-extra')\n{\n\tlet fs: typeof import('fs-extra');\n\n\ttry\n\t{\n\t\tfs = require('fs-extra');\n\t\treturn fs;\n\t}\n\tcatch (e)\n\t{\n\n\t}\n}\n\nexport function parsePathMainBase(pathMain: string)\n{\n\tlet is_out: boolean = null;\n\tlet pathMain_base: string = undefined;\n\n\tif (pathMain != null)\n\t{\n\t\tlet _m = pathMain.match(/^(.+?)(_out)?$/);\n\n\t\tis_out = !!_m[2];\n\t\tpathMain_base = _m[1];\n\t}\n\n\treturn {\n\t\tis_out,\n\t\tpathMain_base,\n\t}\n}\n\nexports = Object.freeze(exports);\n"]}