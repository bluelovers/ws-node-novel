"use strict";
/**
 * Created by user on 2018/2/12/012.
 */
Object.defineProperty(exports, "__esModule", { value: true });
const naturalCompare = require("string-natural-compare");
exports.naturalCompare = naturalCompare;
var EnumToLowerCase;
(function (EnumToLowerCase) {
    EnumToLowerCase[EnumToLowerCase["toLowerCase"] = 1] = "toLowerCase";
    EnumToLowerCase[EnumToLowerCase["toLocaleLowerCase"] = 2] = "toLocaleLowerCase";
})(EnumToLowerCase = exports.EnumToLowerCase || (exports.EnumToLowerCase = {}));
function createSortCallback(options = {}) {
    const r = options.dotNum ? /^(\d+(?:\.\d+)?)/ : /^(\d+)/;
    const failbackSort = options.failbackSort || naturalCompare;
    const trigger = options.trigger || _match;
    let transpile = options.transpile || _trim;
    let transpileBase = options.transpileBase;
    if (options.toLowerCase) {
        if (typeof options.toLowerCase === 'function') {
            const fn = options.toLowerCase;
            transpile = ((old) => {
                return function (input, ...argv) {
                    return fn(old(input, ...argv), ...argv);
                };
            })(transpile);
        }
        else {
            let fn = 'toLowerCase';
            if (typeof options.toLowerCase === 'number') {
                if (options.toLowerCase !== EnumToLowerCase.toLowerCase) {
                    fn = 'toLocaleLowerCase';
                }
            }
            transpile = ((old) => {
                return function (input, ...argv) {
                    return old(input, ...argv)[fn]();
                };
            })(transpile);
        }
    }
    let fnSortCallback = function fnSortCallback(a, b, isSub) {
        if (a === b) {
            return 0;
        }
        let ret = trigger(transpile(a, isSub), transpile(b, isSub), {
            r,
            mainFn: fnSortCallback,
            isSub,
        });
        return (typeof ret == 'number') ? ret : failbackSort(a, b);
    };
    if (transpileBase) {
        fnSortCallback = (function (oldFn) {
            return function (a, b, isSub) {
                if (a === b) {
                    return 0;
                }
                if (isSub) {
                    return oldFn(a, b, isSub);
                }
                return oldFn(transpileBase(a), transpileBase(b), isSub);
            };
        })(fnSortCallback);
    }
    fnSortCallback.failbackSort = failbackSort;
    fnSortCallback.trigger = trigger;
    fnSortCallback.transpile = transpile;
    fnSortCallback.transpileBase = transpileBase;
    fnSortCallback.fnSortCallback = fnSortCallback;
    return fnSortCallback;
}
exports.createSortCallback = createSortCallback;
exports.defaultSortCallback = createSortCallback({
    dotNum: true,
});
exports.default = exports.defaultSortCallback;
function _match(a, b, { r, mainFn, isSub, }) {
    let ta;
    let tb;
    if ((ta = r.exec(a)) && (tb = r.exec(b))) {
        let r = parseInt(ta[0]) - parseInt(tb[0]);
        if (r !== 0) {
            return r;
        }
        let a1 = ta.input.slice(ta[0].length);
        let b1 = tb.input.slice(tb[0].length);
        if (a1 != b1) {
            let i = 0;
            while (typeof a1[i] != 'undefined' && a1[i] == b1[i] && (!/^\d$/.test(b1[0]))) {
                i++;
            }
            a1 = a1.slice(i);
            b1 = b1.slice(i);
        }
        return mainFn(a1, b1, true);
    }
}
exports._match = _match;
function _trim(input) {
    return input
        .replace(/^[_\s]+(\d+)/, '$1')
        .replace(/^\D(\d+)/, '$1')
        .trim();
}
exports._trim = _trim;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJpbmRleC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBQUE7O0dBRUc7O0FBRUgseURBQXlEO0FBMkhoRCx3Q0FBYztBQXpIdkIsSUFBWSxlQUlYO0FBSkQsV0FBWSxlQUFlO0lBRTFCLG1FQUFlLENBQUE7SUFDZiwrRUFBcUIsQ0FBQTtBQUN0QixDQUFDLEVBSlcsZUFBZSxHQUFmLHVCQUFlLEtBQWYsdUJBQWUsUUFJMUI7QUE0QkQsU0FBZ0Isa0JBQWtCLENBQUMsVUFBc0MsRUFBRTtJQUUxRSxNQUFNLENBQUMsR0FBRyxPQUFPLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxrQkFBa0IsQ0FBQyxDQUFDLENBQUMsUUFBUSxDQUFDO0lBRXpELE1BQU0sWUFBWSxHQUFHLE9BQU8sQ0FBQyxZQUFZLElBQUksY0FBYyxDQUFDO0lBQzVELE1BQU0sT0FBTyxHQUFHLE9BQU8sQ0FBQyxPQUFPLElBQUksTUFBTSxDQUFDO0lBQzFDLElBQUksU0FBUyxHQUFHLE9BQU8sQ0FBQyxTQUFTLElBQUksS0FBSyxDQUFDO0lBQzNDLElBQUksYUFBYSxHQUFHLE9BQU8sQ0FBQyxhQUFhLENBQUM7SUFFMUMsSUFBSSxPQUFPLENBQUMsV0FBVyxFQUN2QjtRQUNDLElBQUksT0FBTyxPQUFPLENBQUMsV0FBVyxLQUFLLFVBQVUsRUFDN0M7WUFDQyxNQUFNLEVBQUUsR0FBRyxPQUFPLENBQUMsV0FBVyxDQUFDO1lBRS9CLFNBQVMsR0FBRyxDQUFDLENBQUMsR0FBRyxFQUFFLEVBQUU7Z0JBQ3BCLE9BQU8sVUFBVSxLQUFLLEVBQUUsR0FBRyxJQUFJO29CQUU5QixPQUFPLEVBQUUsQ0FBQyxHQUFHLENBQUMsS0FBSyxFQUFFLEdBQUcsSUFBSSxDQUFDLEVBQUUsR0FBRyxJQUFJLENBQUMsQ0FBQTtnQkFDeEMsQ0FBQyxDQUFBO1lBQ0YsQ0FBQyxDQUFDLENBQUMsU0FBUyxDQUFDLENBQUM7U0FDZDthQUVEO1lB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Q3JlYXRlZCBieSB1c2VyIG9uIDIwMTgvMi8xMi8wMTIuXG4gKi9cblxuaW1wb3J0ICogYXMgbmF0dXJhbENvbXBhcmUgZnJvbSAnc3RyaW5nLW5hdHVyYWwtY29tcGFyZSc7XG5cbmV4cG9ydCBlbnVtIEVudW1Ub0xvd2VyQ2FzZVxue1xuXHR0b0xvd2VyQ2FzZSA9IDEsXG5cdHRvTG9jYWxlTG93ZXJDYXNlID0gMixcbn1cblxuZXhwb3J0IGRlY2xhcmUgZnVuY3Rpb24gZGVmYXVsdFNvcnRDYWxsYmFjayhhOiBzdHJpbmcsIGI6IHN0cmluZywgaXNTdWI/OiBib29sZWFuKTogbnVtYmVyO1xuZXhwb3J0IGRlY2xhcmUgbmFtZXNwYWNlIGRlZmF1bHRTb3J0Q2FsbGJhY2tcbntcblx0ZXhwb3J0IGZ1bmN0aW9uIGZhaWxiYWNrU29ydChhLCBiKTogbnVtYmVyXG5cdGV4cG9ydCBmdW5jdGlvbiB0cmlnZ2VyKGEsIGIsIGRhdGE6IElUcmlnZ2VyRGF0YSk6IG51bWJlclxuXHRleHBvcnQgZnVuY3Rpb24gdHJhbnNwaWxlKGlucHV0LCBpc1N1Yj8sIC4uLmFyZ3YpOiBzdHJpbmdcblx0ZXhwb3J0IGZ1bmN0aW9uIHRyYW5zcGlsZUJhc2UoaW5wdXQsIGlzU3ViPywgLi4uYXJndik6IHN0cmluZ1xuXG5cdGV4cG9ydCBmdW5jdGlvbiBmblNvcnRDYWxsYmFjayhhOiBzdHJpbmcsIGI6IHN0cmluZywgaXNTdWI/OiBib29sZWFuKTogbnVtYmVyXG59XG5cbmV4cG9ydCB0eXBlIElGblNvcnRDYWxsYmFjayA9IHR5cGVvZiBkZWZhdWx0U29ydENhbGxiYWNrO1xuXG5leHBvcnQgdHlwZSBJQ3JlYXRlU29ydENhbGxiYWNrT3B0aW9ucyA9IHtcblx0ZG90TnVtPzogYm9vbGVhbixcblx0dG9Mb3dlckNhc2U/OiBFbnVtVG9Mb3dlckNhc2UgfCBib29sZWFuIHwgKChpbnB1dCwgaXNTdWI/LCAuLi5hcmd2KSA9PiBzdHJpbmcpLFxufSAmIElGblNvcnRDYWxsYmFja1Byb3A7XG5cbmV4cG9ydCBpbnRlcmZhY2UgSUZuU29ydENhbGxiYWNrUHJvcFxue1xuXHRmYWlsYmFja1NvcnQ/KGEsIGIpOiBudW1iZXIsXG5cdHRyaWdnZXI/KGEsIGIsIGRhdGE6IElUcmlnZ2VyRGF0YSk6IG51bWJlcixcblx0dHJhbnNwaWxlPyhpbnB1dCwgaXNTdWI/LCAuLi5hcmd2KTogc3RyaW5nLFxuXHR0cmFuc3BpbGVCYXNlPyhpbnB1dCwgaXNTdWI/LCAuLi5hcmd2KTogc3RyaW5nLFxufVxuXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlU29ydENhbGxiYWNrKG9wdGlvbnM6IElDcmVhdGVTb3J0Q2FsbGJhY2tPcHRpb25zID0ge30pOiBJRm5Tb3J0Q2FsbGJhY2tcbntcblx0Y29uc3QgciA9IG9wdGlvbnMuZG90TnVtID8gL14oXFxkKyg/OlxcLlxcZCspPykvIDogL14oXFxkKykvO1xuXG5cdGNvbnN0IGZhaWxiYWNrU29ydCA9IG9wdGlvbnMuZmFpbGJhY2tTb3J0IHx8IG5hdHVyYWxDb21wYXJlO1xuXHRjb25zdCB0cmlnZ2VyID0gb3B0aW9ucy50cmlnZ2VyIHx8IF9tYXRjaDtcblx0bGV0IHRyYW5zcGlsZSA9IG9wdGlvbnMudHJhbnNwaWxlIHx8IF90cmltO1xuXHRsZXQgdHJhbnNwaWxlQmFzZSA9IG9wdGlvbnMudHJhbnNwaWxlQmFzZTtcblxuXHRpZiAob3B0aW9ucy50b0xvd2VyQ2FzZSlcblx0e1xuXHRcdGlmICh0eXBlb2Ygb3B0aW9ucy50b0xvd2VyQ2FzZSA9PT0gJ2Z1bmN0aW9uJylcblx0XHR7XG5cdFx0XHRjb25zdCBmbiA9IG9wdGlvbnMudG9Mb3dlckNhc2U7XG5cblx0XHRcdHRyYW5zcGlsZSA9ICgob2xkKSA9PiB7XG5cdFx0XHRcdHJldHVybiBmdW5jdGlvbiAoaW5wdXQsIC4uLmFyZ3YpXG5cdFx0XHRcdHtcblx0XHRcdFx0XHRyZXR1cm4gZm4ob2xkKGlucHV0LCAuLi5hcmd2KSwgLi4uYXJndilcblx0XHRcdFx0fVxuXHRcdFx0fSkodHJhbnNwaWxlKTtcblx0XHR9XG5cdFx0ZWxzZVxuXHRcdHtcblx0XHRcdGxldCBmbiA9ICd0b0xvd2VyQ2FzZSc7XG5cblx0XHRcdGlmICh0eXBlb2Ygb3B0aW9ucy50b0xvd2VyQ2FzZSA9PT0gJ251bWJlcicpXG5cdFx0XHR7XG5cdFx0XHRcdGlmIChvcHRpb25zLnRvTG93ZXJDYXNlICE9PSBFbnVtVG9Mb3dlckNhc2UudG9Mb3dlckNhc2UpXG5cdFx0XHRcdHtcblx0XHRcdFx0XHRmbiA9ICd0b0xvY2FsZUxvd2VyQ2FzZSc7XG5cdFx0XHRcdH1cblx0XHRcdH1cblxuXHRcdFx0dHJhbnNwaWxlID0gKChvbGQpID0+IHtcblx0XHRcdFx0cmV0dXJuIGZ1bmN0aW9uIChpbnB1dCwgLi4uYXJndilcblx0XHRcdFx0e1xuXHRcdFx0XHRcdHJldHVybiBvbGQoaW5wdXQsIC4uLmFyZ3YpW2ZuXSgpXG5cdFx0XHRcdH1cblx0XHRcdH0pKHRyYW5zcGlsZSk7XG5cdFx0fVxuXHR9XG5cblx0bGV0IGZuU29ydENhbGxiYWNrOiBJRm5Tb3J0Q2FsbGJhY2sgPSBmdW5jdGlvbiBmblNvcnRDYWxsYmFjayhhOiBzdHJpbmcsIGI6IHN0cmluZywgaXNTdWI/OiBib29sZWFuKTogbnVtYmVyXG5cdHtcblx0XHRpZiAoYSA9PT0gYilcblx0XHR7XG5cdFx0XHRyZXR1cm4gMDtcblx0XHR9XG5cblx0XHRsZXQgcmV0ID0gdHJpZ2dlcih0cmFuc3BpbGUoYSwgaXNTdWIpLCB0cmFuc3BpbGUoYiwgaXNTdWIpLCB7XG5cdFx0XHRyLFxuXHRcdFx0bWFpbkZuOiBmblNvcnRDYWxsYmFjayBhcyBJRm5Tb3J0Q2FsbGJhY2ssXG5cdFx0XHRpc1N1Yixcblx0XHR9KTtcblxuXHRcdHJldHVybiAodHlwZW9mIHJldCA9PSAnbnVtYmVyJykgPyByZXQgOiBmYWlsYmFja1NvcnQoYSwgYik7XG5cdH0gYXMgSUZuU29ydENhbGxiYWNrO1xuXG5cdGlmICh0cmFuc3BpbGVCYXNlKVxuXHR7XG5cdFx0Zm5Tb3J0Q2FsbGJhY2sgPSAoZnVuY3Rpb24gKG9sZEZuKVxuXHRcdHtcblx0XHRcdHJldHVybiBmdW5jdGlvbiAoYTogc3RyaW5nLCBiOiBzdHJpbmcsIGlzU3ViPzogYm9vbGVhbik6IG51bWJlclxuXHRcdFx0e1xuXHRcdFx0XHRpZiAoYSA9PT0gYilcblx0XHRcdFx0e1xuXHRcdFx0XHRcdHJldHVybiAwO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0aWYgKGlzU3ViKVxuXHRcdFx0XHR7XG5cdFx0XHRcdFx0cmV0dXJuIG9sZEZuKGEsIGIsIGlzU3ViKTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdHJldHVybiBvbGRGbih0cmFuc3BpbGVCYXNlKGEpLCB0cmFuc3BpbGVCYXNlKGIpLCBpc1N1Yik7XG5cdFx0XHR9IGFzIElGblNvcnRDYWxsYmFja1xuXHRcdH0pKGZuU29ydENhbGxiYWNrKTtcblx0fVxuXG5cdGZuU29ydENhbGxiYWNrLmZhaWxiYWNrU29ydCA9IGZhaWxiYWNrU29ydDtcblx0Zm5Tb3J0Q2FsbGJhY2sudHJpZ2dlciA9IHRyaWdnZXI7XG5cdGZuU29ydENhbGxiYWNrLnRyYW5zcGlsZSA9IHRyYW5zcGlsZTtcblx0Zm5Tb3J0Q2FsbGJhY2sudHJhbnNwaWxlQmFzZSA9IHRyYW5zcGlsZUJhc2U7XG5cdGZuU29ydENhbGxiYWNrLmZuU29ydENhbGxiYWNrID0gZm5Tb3J0Q2FsbGJhY2s7XG5cblx0cmV0dXJuIGZuU29ydENhbGxiYWNrO1xufVxuXG5leHBvcnQgeyBuYXR1cmFsQ29tcGFyZSB9XG5cbmV4cG9ydHMuZGVmYXVsdFNvcnRDYWxsYmFjayA9IGNyZWF0ZVNvcnRDYWxsYmFjayh7XG5cdGRvdE51bTogdHJ1ZSxcbn0pO1xuXG5leHBvcnQgZGVmYXVsdCBleHBvcnRzLmRlZmF1bHRTb3J0Q2FsbGJhY2sgYXMgdHlwZW9mIGRlZmF1bHRTb3J0Q2FsbGJhY2tcblxuZXhwb3J0IGludGVyZmFjZSBJVHJpZ2dlckRhdGFcbntcblx0cjogUmVnRXhwLFxuXHRtYWluRm46IElGblNvcnRDYWxsYmFjayxcblx0aXNTdWI6IGJvb2xlYW4sXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBfbWF0Y2goYTogc3RyaW5nLCBiOiBzdHJpbmcsIHtcblx0cixcblx0bWFpbkZuLFxuXHRpc1N1Yixcbn06IElUcmlnZ2VyRGF0YSlcbntcblx0bGV0IHRhOiBSZWdFeHBFeGVjQXJyYXk7XG5cdGxldCB0YjogUmVnRXhwRXhlY0FycmF5O1xuXG5cdGlmICgodGEgPSByLmV4ZWMoYSkpICYmICh0YiA9IHIuZXhlYyhiKSkpXG5cdHtcblx0XHRsZXQgciA9IHBhcnNlSW50KHRhWzBdKSAtIHBhcnNlSW50KHRiWzBdKTtcblxuXHRcdGlmIChyICE9PSAwKVxuXHRcdHtcblx0XHRcdHJldHVybiByO1xuXHRcdH1cblxuXHRcdGxldCBhMSA9IHRhLmlucHV0LnNsaWNlKHRhWzBdLmxlbmd0aCk7XG5cdFx0bGV0IGIxID0gdGIuaW5wdXQuc2xpY2UodGJbMF0ubGVuZ3RoKTtcblxuXHRcdGlmIChhMSAhPSBiMSlcblx0XHR7XG5cdFx0XHRsZXQgaSA9IDA7XG5cblx0XHRcdHdoaWxlICh0eXBlb2YgYTFbaV0gIT0gJ3VuZGVmaW5lZCcgJiYgYTFbaV0gPT0gYjFbaV0gJiYgKCEvXlxcZCQvLnRlc3QoYjFbMF0pKSlcblx0XHRcdHtcblx0XHRcdFx0aSsrO1xuXHRcdFx0fVxuXG5cdFx0XHRhMSA9IGExLnNsaWNlKGkpO1xuXHRcdFx0YjEgPSBiMS5zbGljZShpKTtcblx0XHR9XG5cblx0XHRyZXR1cm4gbWFpbkZuKGExLCBiMSwgdHJ1ZSk7XG5cdH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIF90cmltKGlucHV0OiBzdHJpbmcpOiBzdHJpbmdcbntcblx0cmV0dXJuIGlucHV0XG5cdFx0LnJlcGxhY2UoL15bX1xcc10rKFxcZCspLywgJyQxJylcblx0XHQucmVwbGFjZSgvXlxcRChcXGQrKS8sICckMScpXG5cdFx0LnRyaW0oKVxuXHRcdDtcbn1cbiJdfQ==