"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const index_1 = require("../index");
const fs = require("fs-extra");
const path = require("upath2");
const git_1 = require("@git-lazy/util/spawn/git");
const branch_1 = require("@git-lazy/branch");
const moment = require("moment");
const util_1 = require("@git-lazy/util");
async function _createMode001(cwd) {
    let { name, email } = await index_1.git_get_user(cwd);
    let _git_path = path.join(cwd, '.git');
    let _git_path_backup = path.join(cwd, 'backup.git');
    util_1.console.info(`清除 backup.git`);
    await fs.remove(_git_path_backup);
    util_1.console.info(`.git 更名為 backup.git`);
    await fs.move(_git_path, _git_path_backup);
    await git_1.crossSpawnAsync('git', [
        'init',
    ], {
        stdio: 'inherit',
        cwd,
    });
}
exports._createMode001 = _createMode001;
async function _createMode002(cwd) {
    let new_name = 'rebuild/' + moment().format('YYYY-MM-DD-HH-mm-ss');
    await branch_1.createEmptyBranch(new_name, {
        cwd,
    });
    util_1.console.info(`create branch "${new_name}"`);
}
exports._createMode002 = _createMode002;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY3JlYXRlLW5ldy1lbXB0eS5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbImNyZWF0ZS1uZXctZW1wdHkudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFBQSxvQ0FBd0M7QUFDeEMsK0JBQWdDO0FBR2hDLCtCQUFnQztBQUNoQyxrREFBeUc7QUFDekcsNkNBQXFEO0FBQ3JELGlDQUFrQztBQUNsQyx5Q0FBeUM7QUFFbEMsS0FBSyxVQUFVLGNBQWMsQ0FBQyxHQUFXO0lBRS9DLElBQUksRUFBRSxJQUFJLEVBQUUsS0FBSyxFQUFFLEdBQUcsTUFBTSxvQkFBWSxDQUFDLEdBQUcsQ0FBQyxDQUFDO0lBRTlDLElBQUksU0FBUyxHQUFHLElBQUksQ0FBQyxJQUFJLENBQUMsR0FBRyxFQUFFLE1BQU0sQ0FBQyxDQUFDO0lBQ3ZDLElBQUksZ0JBQWdCLEdBQUcsSUFBSSxDQUFDLElBQUksQ0FBQyxHQUFHLEVBQUUsWUFBWSxDQUFDLENBQUM7SUFFcEQsY0FBTyxDQUFDLElBQUksQ0FBQyxlQUFlLENBQUMsQ0FBQztJQUM5QixNQUFNLEVBQUUsQ0FBQyxNQUFNLENBQUMsZ0JBQWdCLENBQUMsQ0FBQztJQUVsQyxjQUFPLENBQUMsSUFBSSxDQUFDLHFCQUFxQixDQUFDLENBQUM7SUFDcEMsTUFBTSxFQUFFLENBQUMsSUFBSSxDQUFDLFNBQVMsRUFBRSxnQkFBZ0IsQ0FBQyxDQUFDO0lBRTNDLE1BQU0scUJBQWUsQ0FBQyxLQUFLLEVBQUU7UUFDNUIsTUFBTTtLQUNOLEVBQUU7UUFDRixLQUFLLEVBQUUsU0FBUztRQUNoQixHQUFHO0tBQ0gsQ0FBQyxDQUFDO0FBQ0osQ0FBQztBQW5CRCx3Q0FtQkM7QUFFTSxLQUFLLFVBQVUsY0FBYyxDQUFDLEdBQVc7SUFFL0MsSUFBSSxRQUFRLEdBQUcsVUFBVSxHQUFHLE1BQU0sRUFBRSxDQUFDLE1BQU0sQ0FBQyxxQkFBcUIsQ0FBQyxDQUFDO0lBRW5FLE1BQU0sMEJBQWlCLENBQUMsUUFBUSxFQUFFO1FBQ2pDLEdBQUc7S0FDSCxDQUFDLENBQUM7SUFFSCxjQUFPLENBQUMsSUFBSSxDQUFDLGtCQUFrQixRQUFRLEdBQUcsQ0FBQyxDQUFDO0FBQzdDLENBQUM7QUFURCx3Q0FTQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGdpdF9nZXRfdXNlciB9IGZyb20gJy4uL2luZGV4JztcbmltcG9ydCBmcyA9IHJlcXVpcmUoJ2ZzLWV4dHJhJyk7XG5pbXBvcnQgQ3Jvc3NTcGF3biA9IHJlcXVpcmUoJ2Nyb3NzLXNwYXduLWV4dHJhJyk7XG5pbXBvcnQgQmx1ZWJpcmQgPSByZXF1aXJlKCdibHVlYmlyZCcpO1xuaW1wb3J0IHBhdGggPSByZXF1aXJlKCd1cGF0aDInKTtcbmltcG9ydCB7IGNoZWNrR2l0T3V0cHV0LCBjcm9zc1NwYXduU3luYywgU3Bhd25PcHRpb25zLCBjcm9zc1NwYXduQXN5bmMgfSBmcm9tICdAZ2l0LWxhenkvdXRpbC9zcGF3bi9naXQnO1xuaW1wb3J0IHsgY3JlYXRlRW1wdHlCcmFuY2ggfSBmcm9tICdAZ2l0LWxhenkvYnJhbmNoJztcbmltcG9ydCBtb21lbnQgPSByZXF1aXJlKCdtb21lbnQnKTtcbmltcG9ydCB7IGNvbnNvbGUgfSBmcm9tICdAZ2l0LWxhenkvdXRpbCc7XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBfY3JlYXRlTW9kZTAwMShjd2Q6IHN0cmluZylcbntcblx0bGV0IHsgbmFtZSwgZW1haWwgfSA9IGF3YWl0IGdpdF9nZXRfdXNlcihjd2QpO1xuXG5cdGxldCBfZ2l0X3BhdGggPSBwYXRoLmpvaW4oY3dkLCAnLmdpdCcpO1xuXHRsZXQgX2dpdF9wYXRoX2JhY2t1cCA9IHBhdGguam9pbihjd2QsICdiYWNrdXAuZ2l0Jyk7XG5cblx0Y29uc29sZS5pbmZvKGDmuIXpmaQgYmFja3VwLmdpdGApO1xuXHRhd2FpdCBmcy5yZW1vdmUoX2dpdF9wYXRoX2JhY2t1cCk7XG5cblx0Y29uc29sZS5pbmZvKGAuZ2l0IOabtOWQjeeCuiBiYWNrdXAuZ2l0YCk7XG5cdGF3YWl0IGZzLm1vdmUoX2dpdF9wYXRoLCBfZ2l0X3BhdGhfYmFja3VwKTtcblxuXHRhd2FpdCBjcm9zc1NwYXduQXN5bmMoJ2dpdCcsIFtcblx0XHQnaW5pdCcsXG5cdF0sIHtcblx0XHRzdGRpbzogJ2luaGVyaXQnLFxuXHRcdGN3ZCxcblx0fSk7XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBfY3JlYXRlTW9kZTAwMihjd2Q6IHN0cmluZylcbntcblx0bGV0IG5ld19uYW1lID0gJ3JlYnVpbGQvJyArIG1vbWVudCgpLmZvcm1hdCgnWVlZWS1NTS1ERC1ISC1tbS1zcycpO1xuXG5cdGF3YWl0IGNyZWF0ZUVtcHR5QnJhbmNoKG5ld19uYW1lLCB7XG5cdFx0Y3dkLFxuXHR9KTtcblxuXHRjb25zb2xlLmluZm8oYGNyZWF0ZSBicmFuY2ggXCIke25ld19uYW1lfVwiYCk7XG59XG4iXX0=